
/**
 * Keetjs v4.0.0 Alpha release: https://github.com/keetjs/keet
 * Minimalist view layer for the web
 *
 * <<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Keetjs >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
 *
 * Copyright 2018, Shahrul Nizam Selamat
 * Released under the MIT License.
 */
!function(){"use strict";function t(t,e){"function"==typeof e&&e(t)}function e(t,i){for(var n=void 0;t;)n=t,t=t.nextSibling,n&&n.nodeType===E?n.isEqualNode(i)?(n.remove(),i=i.nextSibling):e(n.firstChild,i):n.isEqualNode(i)&&(n.remove(),i=i.nextSibling)}function i(t,i,n,o,r){var l=void 0,a=void 0,s=void 0,d=document.createDocumentFragment();if("initial"!==n||M.hasOwnProperty(i)){if("conditional-set"===n){if(t.nextSibling.isEqualNode(M[i].frag.firstChild))return;s=M[i].frag.cloneNode(!0),o.call(this,s.firstChild,r),t.parentNode.insertBefore(s,t.nextSibling)}}else for(a=t;a;)l=a,a=a.nextSibling,l.nodeType!==E&&l.nodeValue.match(j)?(a=null,M[i]=M[i]||{},e(this.__pristineFragment__.firstChild,d.firstChild),M[i].frag=d):l.nodeType!==F&&d.appendChild(l)}function n(t){for(;t;)L=t,t=t.nextSibling,L.nodeType===R?n.call(this,L.firstChild):L.nodeType===U&&L.nodeValue.match(B)&&(q=L.nodeValue.trim().match(G),W=W.concat(q),$=$.concat(L))}function o(e){W=[],$=[],n.call(this,this.base.firstChild);for(var o=W.length;o>0;)o--,t(W[o],e.bind(this)),i.call(this,$[o],W[o],"initial")}function r(t,e){var i=t.getElementById(e);i&&i.childNodes[1].remove()}function l(t,e,i){var n=void 0,o=void 0,l=void 0,a=void 0,s=void 0,d=void 0,u=void 0;if(z[e]=z[e]||{},d=this[e]&&this[e].enableFiltering?"listFilter":"list",z[e][d]||(z[e][d]=t.nextSibling.cloneNode(!0),t.nextSibling.remove(),r(this.__pristineFragment__,t.parentNode.id)),s=z[e][d],void 0!==this[e]&&this[e].hasOwnProperty(d)){if(a=t.parentNode,n=this[e][d],!this[e].dirty)return void a.setAttribute("pristine-model","");for(o=0,u=n.length;o<u;)l=s.cloneNode(!0),i.call(this,l,null,n[o]),l.setAttribute("kdata-id",n[o]["kdata-id"]),a.insertBefore(l,a.lastChild),o++;this[e].dirty=!1}}function a(t){if(window&&"object"===Q(window.__keetGlobalComponentRef__))return window.__keetGlobalComponentRef__[t]}function s(t,e){var i=t.replace("component:",""),n=this[i]||a(i);void 0!==n?tt[n.ID]?Z(n.el)?(e.parentNode.replaceChild(tt[n.ID].cloneNode(!0),e),n.callBatchPoolUpdate()):(n.base=n.__pristineFragment__.cloneNode(!0),n.render(!0),e.parentNode.replaceChild(n.base,e)):(n.render(!0),tt[n.ID]=n.base.cloneNode(!0),e.parentNode.replaceChild(n.base,e)):J(!1,"Component "+i+" does not exist.")}function d(t,e,i){var n=void 0,o=void 0;t.match(et)&&(n=t.replace(et,"$1").trim(),n.match(it)?(o=n.replace("model:",""),l.call(this,e,o,i)):n.match(nt)&&s.call(this,n,e))}function u(t){if(t.match(/([^?]*)\?([^:]*):([^;]*)|(\s*=\s*)[^;]*/g)){var e=t.split("?"),i=e[0],n=e[1].split(":")[0],o=e[1].split(":")[1];return!!this&&(this[i]?{value:ot(n),state:i}:{value:ot(o),state:i})}return!1}function c(t,e,i,n){t.nodeValue=t.nodeValue.replace(RegExp(i,"g"),n)}function h(e,i,n,o,r){var l=e.match(lt);if(l)for(var a=l.length,s=void 0,d=void 0,h=void 0,f=this,p=r||this;a;)if(a--,s=l[a].replace(lt,"$1"),d=u.call(p,s),h=rt(s)){if(o){if("this"===h[0]&&void 0!==f[h[1]]&&"function"==typeof f[h[1]]){var m=f[h[1]](p);return void 0!==m?m:e}return t(s,n),e.replace(l,f[h[0]][h[1]])}if("this"===h[0]&&void 0!==f[h[1]]&&"function"==typeof f[h[1]]){var v=f[h[1]]();void 0!==v&&c(i,e,"{{"+s+"}}",v)}else t(s,n),c(i,e,"{{"+s+"}}",f[h[0]][h[1]])}else if(d){if(t(d.state,n),o)return e.replace(l,d.value);c(i,e,"{{"+s+"}}",d.value)}else if(void 0!==p[s]){if(t(s,n),o)return e.replace(l,p[s]);c(i,e,"{{"+s+"}}",p[s])}}function f(t,e,i){var n=t.attributes,o=0,r=void 0,l=void 0,a=void 0;for(o=n.length;o--;)r=n[o],a=r.localName,l=r.nodeValue,at.test(a)?(t.removeAttribute(a),a=h.call(this,a,t,e,!0,i),t.setAttribute(a,l)):at.test(l)&&(l=h.call(this,l,t,e,!0,i),"checked"===a?""===l?t.removeAttribute(a):t.setAttribute(a,""):""===l?t.setAttribute(a,""):t.setAttribute(a,l))}function p(t,e){for(var i=void 0;e;){if(i=e,e=e.parentNode,i.nodeType===st&&i.hasAttribute("kdata-id"))return{id:i.getAttribute("kdata-id"),node:i};i.isEqualNode(t)&&(e=null)}}function m(t,e){var i=Object.keys(e)[0],n=e[i];void 0!==this[n]&&"function"==typeof this[n]&&t.addEventListener(i,this[n].bind(this),!!e.useCapture)}function v(t,e,i,n){if(n.stopPropagation(),n.target!==n.currentTarget){var o=p(i,n.target);this[e](t.list[ut(o.id,t)],n.target,o.node,n)}}function b(t,e){var i=Object.keys(e)[0],n=e[i];if(void 0!==this[n]&&"function"==typeof this[n]){var o=t.firstChild.nodeValue.replace(dt,"$1").trim();o=o.replace("model:","");t.addEventListener(i,v.bind(this,this[o],n,t),!!e.useCapture)}}function g(t){for(var e=t.attributes,i=0,n=void 0,o=void 0,r=void 0,l=void 0,a=void 0,s=[],d=void 0,u=void 0;i<e.length;)n=e[i],o=n.localName,r=n.nodeValue,/^k-/.test(o)&&(l=o.replace(/^k-/,""),a=r.match(/[a-zA-Z]+(?![^(]*\))/)[0],u=r.match(/\(([^{}]+)\)/),u=u?u[1]:"",d={},d[l]=a,u&&(d[u]=!0),d.isModel=!1,s.push(d),t.hasChildNodes()&&t.firstChild.nodeType!==mt&&t.firstChild.nodeValue.match(pt)&&(d.isModel=!0)),i++;return s}function y(t,e,n){for(var o=this;t;)yt=t,t=t.nextSibling,yt.nodeType===mt?(yt.hasAttributes()&&(f.call(this,yt,e,n),Z(yt.id)||(bt=g.call(this,yt),bt.length&&bt.map(function(t){t.isModel?b.call(o,yt,t):m.call(o,yt,t),yt.removeAttribute("k-"+Object.keys(t)[0])}))),y.call(this,yt.firstChild,e,n)):yt.nodeType===vt&&yt.nodeValue.match(ct)?(gt=yt.nodeValue.trim().match(ht),gt=gt&&gt[0],this[gt]&&i.call(this,yt,gt,"conditional-set",C,e)):yt.nodeType===vt&&yt.nodeValue.match(ft)&&!yt.nodeValue.match(ct)?d.call(this,yt.nodeValue,yt,C):h.call(this,yt.nodeValue,yt,e,null,n)}function C(t,e,i){y.call(this,t,e,i)}function _(t,e){return x(e)||N(t)&&N(e)||t.isEqualNode(e)}function N(t){return null!=t.getAttribute("data-ignore")}function k(t,e){"INPUT"===t.nodeName&&t.checked!==e.checked&&(t.checked=e.checked)}function T(t,e){for(var i=e.attributes,n={},o=0;o<i.length;)n[i[o].name]=i[o].value,o++;for(var r=t.attributes,l={},a=0;a<r.length;)l[r[a].name]=r[a].value,a++;for(var s in n)t.attributes[s]&&t.attributes[s].name===s&&t.attributes[s].value!==n[s]?t.setAttribute(s,n[s]):t.hasAttribute(s)||/^k-/.test(s)||t.setAttribute(s,n[s]);for(var d in l)e.attributes[d]&&t.attributes[d]||t.removeAttribute(d)}function I(t,e){if(t.nodeType===e.nodeType)if(t.nodeType===Ct){if(k(t,e),_(t,e))return;D(t.firstChild,e.firstChild),t.nodeName===e.nodeName?T(t,e):t.parentNode.replaceChild(e,t)}else t.nodeValue!==e.nodeValue&&(t.nodeValue=e.nodeValue);else t.parentNode.replaceChild(e,t)}function A(t,e){return t.length-e-1}function D(t,e,i){for(var n=0,o=[];e;)n++,_t=e,e=i?null:e.nextSibling,o.push(_t);for(var r=void 0,l=t&&t.parentNode;t;)if(n--,Nt=t,t=i?null:t.nextSibling,r=A(o,n),Nt&&o[r]?I(Nt,o[r]):Nt&&!o[r]&&l.removeChild(Nt),null===t)for(;n>0;)n--,r=A(o,n),l.appendChild(o[r])}function x(t){return t.hasAttribute("pristine-model")}function S(t){var e=Z(this.el);e&&!this.IS_STUB?D(e.firstChild,t):e&&!x(t)&&D(e.firstChild,t.firstChild)}function w(){St[this.ID]&&(St[this.ID]=[])}function V(t){St[this.ID]=St[this.ID]||[],St[this.ID].indexOf(t)===-1&&(St[this.ID]=St[this.ID].concat(t))}function O(t){o.call(this,V.bind(this)),C.call(this,this.base.firstChild,V.bind(this));var e=t||Z(this.el);e?(e.nodeType===Vt?e.setAttribute("data-ignore",""):(J(1===this.base.childNodes.length,"Sub-component should only has a single rootNode."),!this.base.firstChild.hasAttribute("data-ignore")&&this.base.firstChild.setAttribute("data-ignore","")),xt.call(this),t||e.appendChild(this.base),this.componentDidMount&&"function"==typeof this.componentDidMount&&this.componentDidMount()):J(!1,'No element with id: "'+this.el+'" exist.')}function P(t){var e=void 0,i=void 0,n=document.createDocumentFragment();if("string"==typeof t)for(e=t.trim().replace(/\s+/g," "),i=document.createElement("div"),i.innerHTML=e;i.firstChild;)n.appendChild(i.firstChild);else"object"===(void 0===t?"undefined":Q(t))&&t.nodeType?t.nodeType===Mt?n.appendChild(t):t.nodeType===Et?n=t:t.nodeType===Ft?n.appendChild(t):J(!1,"Unable to parse instance, unknown type."):J(!1,"Parameter is not a string or a html element.");return this.__pristineFragment__=n.cloneNode(!0),this.base=n,w.call(this),this}var j=/\{\{\/([^{}]+)\}\}/g,E=1,F=8,M={},R=1,U=8,B=/\{\{\?([^{}]+)\}\}/g,G=/([^{?])(.*?)(?=\}\})/g,q=void 0,L=void 0,W=void 0,$=void 0,z={},H=function(){var t=function(){return(1*Math.random()*1e17).toString(36)};return"KDATA-"+t()+"-"+t()},K=function(){return(1*Math.random()*1e17).toString(36)},Z=function(t){return document.getElementById(t)},J=function(t,e){if(!t)throw Error("(keet) "+e)},Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),Y=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},tt={},et=/{{([^{}]+)}}/g,it=/^model:/g,nt=/^component:([^{}]+)/g,ot=function(t){return"''"===t||'""'===t||"null"===t?"":t},rt=function(t){var e=t.match(/\.*\./g);return e&&e.length>0?t.split("."):void 0},lt=/{{([^{}]+)}}/g,at=/{{([^{}]+)}}/g,st=1,dt=/{{([^{}]+)}}/g,ut=function(t,e){return e.list.map(function(t){return t["kdata-id"]}).indexOf(t)},ct=/\{\{\?([^{}]+)\}\}/g,ht=/([^{?])(.*?)(?=\}\})/g,ft=/{{([^{}]+)}}/g,pt=/\{\{model:([^{}]+)\}\}/g,mt=1,vt=8,bt=void 0,gt=void 0,yt=void 0,Ct=1,_t=void 0,Nt=void 0,kt=0,Tt=function(){wt.call(this),this.componentDidUpdate&&"function"==typeof this.componentDidUpdate&&this.componentDidUpdate()},It={},At=function(t,e){var i=this;It[this.ID]=It[this.ID]||null,clearTimeout(It[this.ID]),It[this.ID]=setTimeout(function(){return t.call(i)},e)},Dt=function t(e){var i=this,n=void 0,o=void 0;if(St[this.ID]&&e<St[this.ID].length){if(n=St[this.ID][e],o=this[n],void 0===o&&(o=rt(n)),o&&Array.isArray(o)){var r=this[o[0]][o[1]];Object.defineProperty(this[o[0]],o[1],{enumerable:!1,configurable:!0,get:function(){return r},set:function(t){r=t,At.call(i,Tt,kt)}})}else Object.defineProperty(this,n,{enumerable:!1,configurable:!0,get:function(){return o},set:function(t){o=t,At.call(i,Tt,kt)}});e++,t.call(this,e)}},xt=function(){Dt.call(this,0)},St={},wt=function(){this.base=this.__pristineFragment__.cloneNode(!0),C.call(this,this.base.firstChild,V.bind(this)),S.call(this,this.base.firstChild)},Vt=1,Ot=function(t,e){return t["kdata-id"]!==e["kdata-id"]},Pt={},jt=function(){for(var t=this,e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];Pt[this.mId]&&clearTimeout(Pt[this.mId]),Pt[this.mId]=setTimeout(function(){return t.exec&&"function"==typeof t.exec&&t.exec.apply(null,i)},0)},Et=(function(){function t(t){this.mId=this.indentity,Pt[this.mId]=null,this.enableFiltering=t||null,this.model=[],Object.defineProperty(this,"list",{enumerable:!1,configurable:!0,get:function(){return this.model},set:function(t){this.model=t,this.dirty=!0,jt.call(this,this.model,this.listFilter)}}),Object.defineProperty(this,"listFilter",{enumerable:!1,configurable:!0,get:function(){var t=this;return this.prop?this.model.filter(function(e){return e[t.prop]===t.value}):this.model}})}return t.prototype.subscribe=function(t){this.exec=t},t.prototype.add=function(t){this.list=this.list.concat(Y({},t,{"kdata-id":K()}))},t.prototype.update=function(t){this.list=this.list.map(function(e){return Ot(e,t)?e:t})},t.prototype.filter=function(t,e){this.prop=t,this.value=e,this.list=this.list},t.prototype.destroy=function(t){this.list=this.list.filter(function(e){return Ot(e,t)})},X(t,null,[{key:"indentity",get:function(){return K()}}]),t}(),11),Ft=3,Mt=1;(function(){function t(e){this.ID=t.indentity,e&&this.storeRef(e)}return t.prototype.mount=function(t){return P.call(this,t)},t.prototype.link=function(t){return t||J(t,"No id is given as parameter."),this.el=t,this.render(),this},t.prototype.render=function(t){this.componentWillMount&&"function"==typeof this.componentWillMount&&this.componentWillMount(),t&&(this.IS_STUB=!0),O.call(this,t)},t.prototype.callBatchPoolUpdate=function(){At.call(this,Tt,1)},t.prototype.subscribe=function(t){this.exec=t},t.prototype.inform=function(t){this.exec&&"function"==typeof this.exec&&this.exec(t)},t.prototype.storeRef=function(t){window.__keetGlobalComponentRef__=window.__keetGlobalComponentRef__||{},window.__keetGlobalComponentRef__[t]?J(!1,"The component name: "+t+" already exist in the global pool."):window.__keetGlobalComponentRef__[t]=this},X(t,null,[{key:"indentity",get:function(){return H()}}]),t})()}();
//# sourceMappingURL=keet-min.js.map