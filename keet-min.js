
//
// Keetjs v4.1.1 Alpha release: https://github.com/keetjs/keet
// Minimalist view layer for the web
//
// <<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Keetjs >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
//
// Copyright 2018, Shahrul Nizam Selamat
// Released under the MIT License.
//
var keet=function(t){"use strict";function e(t,e){"function"==typeof e&&e(t)}function i(t,e){for(var n=void 0;t;)n=t,t=t.nextSibling,n&&n.nodeType===q?n.isEqualNode(e)?(n.remove(),e=e.nextSibling):i(n.firstChild,e):n.isEqualNode(e)&&(n.remove(),e=e.nextSibling)}function n(t,e,n,o,r){var l=void 0,a=void 0,s=void 0,d=document.createDocumentFragment();if("initial"!==n||L.hasOwnProperty(e)){if("conditional-set"===n){if(t.nextSibling.isEqualNode(L[e].frag.firstChild))return;s=L[e].frag.cloneNode(!0),o.call(this,s.firstChild,r),t.parentNode.insertBefore(s,t.nextSibling)}}else for(a=t;a;)l=a,a=a.nextSibling,l.nodeType!==q&&l.nodeValue.match(B)?(a=null,L[e]=L[e]||{},i(this.__pristineFragment__.firstChild,d.firstChild),L[e].frag=d):l.nodeType!==$&&d.appendChild(l)}function o(t){for(;t;)J=t,t=t.nextSibling,J.nodeType===W?o.call(this,J.firstChild):J.nodeType===z&&J.nodeValue.match(H)&&(Z=J.nodeValue.trim().match(K),Q=Q.concat(Z),X=X.concat(J))}function r(t){Q=[],X=[],o.call(this,this.base.firstChild);for(var i=Q.length;i>0;)i--,e(Q[i],t.bind(this)),n.call(this,X[i],Q[i],"initial")}function l(t,e){var i=t.getElementById(e);i&&i.childNodes[1].remove()}function a(t,e,i){var n=void 0,o=void 0,r=void 0,a=void 0,s=void 0,d=void 0,c=void 0;if(rt[e]=rt[e]||{},d=this[e]&&this[e].enableFiltering?"listFilter":"list",rt[e][d]||(rt[e][d]=t.nextSibling.cloneNode(!0),t.nextSibling.remove(),l(this.__pristineFragment__,t.parentNode.id)),s=rt[e][d],void 0!==this[e]&&this[e].hasOwnProperty(d)){if(a=t.parentNode.nodeType===ot?et(this.el):t.parentNode,n=this[e][d],!this[e].dirty)return void a.setAttribute("pristine-model","");for(o=0,c=n.length;o<c;)r=s.cloneNode(!0),i.call(this,r,null,n[o]),r.setAttribute("kdata-id",n[o]["kdata-id"]),a.insertBefore(r,a.lastChild),o++;this[e].dirty=!1}}function s(t){if(window&&"object"===lt(window.__keetGlobalComponentRef__)){var e=window.__keetGlobalComponentRef__.map(function(t){return t.indentifier}).indexOf(t);if(~e)return window.__keetGlobalComponentRef__[e].component}}function d(t,e){var i=t.replace("component:",""),n=this[i]||s(i);void 0!==n?dt[n.ID]?et(n.el)?(e.parentNode.replaceChild(dt[n.ID].cloneNode(!0),e),n.callBatchPoolUpdate()):(n.base=n.__pristineFragment__.cloneNode(!0),n.render(!0),e.parentNode.replaceChild(n.base,e)):(n.render(!0),dt[n.ID]=n.base.cloneNode(!0),e.parentNode.replaceChild(n.base,e)):it(!1,"Component "+i+" does not exist.")}function c(t){var e=void 0,i=void 0;return"string"==typeof t&&(e=t.match(ct),e&&e.length&&(this.IS_SVG=!0,e.map(function(e){i=tt(),ut[i]=e,t=t.replace(e,"<!-- {{svg:"+i+"}} -->")}))),t}function u(t){for(var e=void 0;t;)e=t,t=t.nextSibling,e.nodeType===ft?u(e.firstChild):e.nodeType===ht&&" "===e.nodeValue&&e.remove()}function h(t,e){var i=document.createElement("div");for(i.innerHTML=e,u(i.firstChild);i.firstChild;)t.appendChild(i.firstChild)}function f(t){if(t.match(/([^?]*)\?([^:]*):([^;]*)|(\s*=\s*)[^;]*/g)){var e=t.split("?"),i=e[0],n=e[1].split(":")[0],o=e[1].split(":")[1];return!!this&&(this[i]?{value:pt(n),state:i}:{value:pt(o),state:i})}return!1}function p(t,i,n){i&&(n=!1),i=i||this;var o=t.match(/{{([^{}]+)}}/g);for(bt=t,_t=0,Ct=o.length;_t<Ct;_t++){if(gt=o[_t].replace(/{{([^{}]+)}}/g,"$1"),yt=f.call(i,gt),Nt=vt(gt),yt)e(gt,n),bt=bt.replace("{{"+gt+"}}",yt.value);else if(Nt){if("this"===Nt[0]&&"function"==typeof this[Nt[1]]){var r=this[Nt[1]](i);void 0!==r&&(bt=bt.replace("{{"+gt+"}}",r))}}else void 0!==i[gt]&&(e(gt,n),bt=bt.replace("{{"+gt+"}}",i[gt]));kt=bt.match(mt),kt&&(bt=17===kt[0].length?bt.replace(' checked="checked"'," checked"):bt.replace(' checked=""',""))}return bt}function v(t,e,i,n){var o=t.replace("svg:",""),r=ut[o],l=p.call(this,r,i,n);l.match(It)||(h(Tt,l),e.parentNode.replaceChild(Tt.firstChild,e))}function m(t,e,i,n,o){var r=void 0,l=void 0;t.match(xt)&&(r=t.replace(xt,"$1").trim(),r.match(At)?(l=r.replace("model:",""),a.call(this,e,l,i)):r.match(St)?d.call(this,r,e):this.IS_SVG&&r.match(Dt)&&v.call(this,r,e,n,o))}function b(t,e,i){t.nodeValue=t.nodeValue.replace(RegExp(e,"g"),i)}function g(t,i,n,o,r){var l=t.match(wt);if(l)for(var a=l.length,s=void 0,d=void 0,c=void 0,u=this,h=r||this;a;)if(a--,s=l[a].replace(wt,"$1"),d=f.call(h,s),c=vt(s)){if(o){if("this"===c[0]&&void 0!==u[c[1]]&&"function"==typeof u[c[1]]){var p=u[c[1]](h);return void 0!==p?p:t}return e(s,n),t.replace(l,u[c[0]][c[1]])}if("this"===c[0]&&void 0!==u[c[1]]&&"function"==typeof u[c[1]]){var v=u[c[1]]();void 0!==v&&b(i,"{{"+s+"}}",v)}else e(s,n),b(i,"{{"+s+"}}",u[c[0]][c[1]])}else if(d){if(e(d.state,n),o)return t.replace(l,d.value);s=s.replace("?","\\?"),b(i,"{{"+s+"}}",d.value)}else if(void 0!==h[s]){if(e(s,n),o)return t.replace(l,h[s]);b(i,"{{"+s+"}}",h[s])}}function y(t,e,i){var n=t.attributes,o=0,r=void 0,l=void 0,a=void 0;for(o=n.length;o--;)r=n[o],a=r.localName,l=r.nodeValue,Vt.test(a)?(t.removeAttribute(a),a=g.call(this,a,t,e,!0,i),t.setAttribute(a,l)):Vt.test(l)&&(l=g.call(this,l,t,e,!0,i),"checked"===a?""===l?t.removeAttribute(a):t.setAttribute(a,""):""===l?t.setAttribute(a,""):t.setAttribute(a,l))}function _(t,e){for(var i=void 0;e;){if(i=e,e=e.parentNode,i.nodeType===Ot&&i.hasAttribute("kdata-id"))return{id:i.getAttribute("kdata-id"),node:i};i.isEqualNode(t)&&(e=null)}}function C(t,e){var i=Object.keys(e)[0],n=e[i];void 0!==this[n]&&"function"==typeof this[n]&&t.addEventListener(i,this[n].bind(this),!!e.useCapture)}function k(t,e,i,n){if(n.stopPropagation(),n.target!==n.currentTarget){var o=_(i,n.target);this[e](t.list[Et(o.id,t)],n.target,o.node,n)}}function N(t,e){var i=Object.keys(e)[0],n=e[i];if(void 0!==this[n]&&"function"==typeof this[n]){var o=t.firstChild.nodeValue.replace(jt,"$1").trim();o=o.replace("model:","");t.addEventListener(i,k.bind(this,this[o],n,t),!!e.useCapture)}}function I(t){for(var e=t.attributes,i=0,n=void 0,o=void 0,r=void 0,l=void 0,a=void 0,s=[],d=void 0,c=void 0;i<e.length;)n=e[i],o=n.localName,r=n.nodeValue,/^k-/.test(o)&&(l=o.replace(/^k-/,""),a=r.match(/[a-zA-Z]+(?![^(]*\))/)[0],c=r.match(/\(([^{}]+)\)/),c=c?c[1]:"",d={},d[l]=a,c&&(d[c]=!0),d.isModel=!1,s.push(d),t.hasChildNodes()&&t.firstChild.nodeType!==Gt&&t.firstChild.nodeValue.match(Rt)&&(d.isModel=!0)),i++;return s}function T(t,e,i){for(var o=this;t;)$t=t,t=t.nextSibling,$t.nodeType===Gt?($t.hasAttributes()&&(y.call(this,$t,e,i),et($t.id)||(Bt=I.call(this,$t),Bt.length&&Bt.map(function(t){t.isModel?N.call(o,$t,t):C.call(o,$t,t),$t.removeAttribute("k-"+Object.keys(t)[0])}))),T.call(this,$t.firstChild,e,i)):$t.nodeType===Ut&&$t.nodeValue.match(Ft)?(qt=$t.nodeValue.trim().match(Mt),qt=qt&&qt[0],this[qt]&&n.call(this,$t,qt,"conditional-set",x,e)):$t.nodeType===Ut&&$t.nodeValue.match(Pt)&&!$t.nodeValue.match(Ft)?m.call(this,$t.nodeValue,$t,x,i,e):g.call(this,$t.nodeValue,$t,e,null,i)}function x(t,e,i){T.call(this,t,e,i)}function A(t,e){return F(e)||S(t,e)||t.isEqualNode(e)}function S(t,e){return D(t)&&D(e)}function D(t){return null!=t.getAttribute("data-ignore")}function w(t,e){"INPUT"===t.nodeName&&t.checked!==e.checked&&(t.checked=e.checked)}function V(t,e){for(var i=e.attributes,n={},o=0;o<i.length;)n[i[o].name]=i[o].value,o++;for(var r=t.attributes,l={},a=0;a<r.length;)l[r[a].name]=r[a].value,a++;for(var s in n)t.attributes[s]&&t.attributes[s].name===s&&t.attributes[s].value!==n[s]?t.setAttribute(s,n[s]):t.hasAttribute(s)||/^k-/.test(s)||t.setAttribute(s,n[s]);for(var d in l)e.attributes[d]&&t.attributes[d]||t.removeAttribute(d)}function O(t,e){if(t.nodeType===e.nodeType)if(t.nodeType===Lt){if(w(t,e),A(t,e))return;E(t.firstChild,e.firstChild),t.nodeName===e.nodeName?V(t,e):t.parentNode.replaceChild(e,t)}else t.nodeValue!==e.nodeValue&&(t.nodeValue=e.nodeValue);else t.parentNode.replaceChild(e,t)}function j(t,e){return t.length-e-1}function E(t,e){for(var i=0,n=[];e;)i++,Wt=e,e=e.nextSibling,n.push(Wt);for(var o=void 0,r=t&&t.parentNode;t;)if(i--,zt=t,t=t.nextSibling,o=j(n,i),zt&&n[o]?O(zt,n[o]):zt&&!n[o]&&r.removeChild(zt),null===t)for(;i>0;)i--,o=j(n,i),r.appendChild(n[o])}function F(t){return t.hasAttribute("pristine-model")}function M(t){var e=et(this.el);e&&!this.IS_STUB?E(e.firstChild,t):e&&!F(t)&&E(e.firstChild,t.firstChild)}function P(){Yt[this.ID]&&(Yt[this.ID]=[])}function R(t){Yt[this.ID]=Yt[this.ID]||[],Yt[this.ID].indexOf(t)===-1&&(Yt[this.ID]=Yt[this.ID].concat(t))}function G(t){r.call(this,R.bind(this)),x.call(this,this.base.firstChild,R.bind(this));var e=t||et(this.el);e?(e.nodeType===ee?e.setAttribute("data-ignore",""):(it(1===this.base.childNodes.length,"Sub-component should only has a single rootNode."),!this.base.firstChild.hasAttribute("data-ignore")&&this.base.firstChild.setAttribute("data-ignore","")),Xt.call(this),t||e.appendChild(this.base),this.componentDidMount&&"function"==typeof this.componentDidMount&&this.componentDidMount()):it(!1,'No element with id: "'+this.el+'" exist.')}function U(t){var e=void 0,i=document.createDocumentFragment();return P.call(this),"string"==typeof t?(e=t.trim().replace(/\s+/g," "),e=c.call(this,e),h(i,e)):"object"===(void 0===t?"undefined":lt(t))&&t.nodeType?t.nodeType===se?i.appendChild(t):t.nodeType===le?i=t:t.nodeType===ae?i.appendChild(t):it(!1,"Unable to parse instance, unknown type."):it(!1,"Parameter is not a string or a html element."),this.__pristineFragment__=i.cloneNode(!0),this.base=i,this}var B=/\{\{\/([^{}]+)\}\}/g,q=1,$=8,L={},W=1,z=8,H=/\{\{\?([^{}]+)\}\}/g,K=/([^{?])(.*?)(?=\}\})/g,Z=void 0,J=void 0,Q=void 0,X=void 0,Y=function(){var t=function(){return(1*Math.random()*1e17).toString(36)};return"KDATA-"+t()+"-"+t()},tt=function(){return(1*Math.random()*1e17).toString(36)},et=function(t){return document.getElementById(t)},it=function(t,e){if(!t)throw Error("(keet) "+e)},nt=function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];var n=e.shift(),o=e.slice(),r=n.raw.reduce(function(t,e,i){return t+o[i-1]+e});return r=r.split(/\n+/),r=r.map(function(t){return t.trim()}).join("")},ot=11,rt={},lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},at=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),st=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},dt={},ct=/(<svg)([^<]*|[^>]*)(.*?)(?=<\/svg>)/g,ut={},ht=3,ft=1,pt=function(t){return"''"===t||'""'===t||"null"===t?"":t},vt=function(t){var e=t.match(/\.*\./g);return e&&e.length>0?t.split("."):void 0},mt=RegExp(/(\schecked=")(.*?)(?=")/g),bt="",gt=void 0,yt=void 0,_t=void 0,Ct=void 0,kt=void 0,Nt=void 0,It=/{{([^{}]+)}}/g,Tt=document.createDocumentFragment(),xt=/{{([^{}]+)}}/g,At=/^model:/g,St=/^component:([^{}]+)/g,Dt=/^svg:([^{}]+)/g,wt=/{{([^{}]+)}}/g,Vt=/{{([^{}]+)}}/g,Ot=1,jt=/{{([^{}]+)}}/g,Et=function(t,e){return e.list.map(function(t){return t["kdata-id"]}).indexOf(t)},Ft=/\{\{\?([^{}]+)\}\}/g,Mt=/([^{?])(.*?)(?=\}\})/g,Pt=/{{([^{}]+)}}/g,Rt=/\{\{model:([^{}]+)\}\}/g,Gt=1,Ut=8,Bt=void 0,qt=void 0,$t=void 0,Lt=1,Wt=void 0,zt=void 0,Ht=0,Kt=function(){te.call(this),this.componentDidUpdate&&"function"==typeof this.componentDidUpdate&&this.componentDidUpdate()},Zt={},Jt=function(t,e){var i=this;Zt[this.ID]=Zt[this.ID]||null,clearTimeout(Zt[this.ID]),Zt[this.ID]=setTimeout(function(){return t.call(i)},e)},Qt=function t(e){var i=this,n=void 0,o=void 0;if(Yt[this.ID]&&e<Yt[this.ID].length){if(n=Yt[this.ID][e],o=this[n],void 0===o&&(o=vt(n)),o&&Array.isArray(o)){var r=this[o[0]][o[1]];Object.defineProperty(this[o[0]],o[1],{enumerable:!1,configurable:!0,get:function(){return r},set:function(t){r=t,Jt.call(i,Kt,Ht)}})}else Object.defineProperty(this,n,{enumerable:!1,configurable:!0,get:function(){return o},set:function(t){o=t,Jt.call(i,Kt,Ht)}});e++,t.call(this,e)}},Xt=function(){Qt.call(this,0)},Yt={},te=function(){this.base=this.__pristineFragment__.cloneNode(!0),x.call(this,this.base.firstChild,R.bind(this)),M.call(this,this.base.firstChild)},ee=1,ie=function(t,e){return t["kdata-id"]!==e["kdata-id"]},ne={},oe=function(){for(var t=this,e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];ne[this.mId]&&clearTimeout(ne[this.mId]),ne[this.mId]=setTimeout(function(){return t.exec&&"function"==typeof t.exec&&t.exec.apply(null,i)},0)},re=function(){function t(e){this.mId=t.genIdentity,ne[this.mId]=null,this.enableFiltering=e||null,this.model=[],Object.defineProperty(this,"list",{enumerable:!1,configurable:!0,get:function(){return this.model},set:function(t){this.model=t,this.dirty=!0,oe.call(this,this.model,this.listFilter)}}),Object.defineProperty(this,"listFilter",{enumerable:!1,configurable:!0,get:function(){var t=this;return this.prop?this.model.filter(function(e){return e[t.prop]===t.value}):this.model}})}return t.prototype.subscribe=function(t){this.exec=t},t.prototype.add=function(t){this.list=this.list.concat(st({},t,{"kdata-id":tt()}))},t.prototype.update=function(t){this.list=this.list.map(function(e){return ie(e,t)?e:t})},t.prototype.filter=function(t,e){this.prop=t,this.value=e,this.list=this.list},t.prototype.destroy=function(t){this.list=this.list.filter(function(e){return ie(e,t)})},at(t,null,[{key:"genIdentity",get:function(){return tt()}}]),t}(),le=11,ae=3,se=1;return t.default=function(){function t(e){this.ID=t.indentity,e&&this.storeRef(e)}return t.prototype.mount=function(t){return U.call(this,t)},t.prototype.link=function(t){return t||it(t,"No id is given as parameter."),this.el=t,this.render(),this},t.prototype.render=function(t){this.componentWillMount&&"function"==typeof this.componentWillMount&&this.componentWillMount(),t&&(this.IS_STUB=!0),G.call(this,t)},t.prototype.callBatchPoolUpdate=function(){Jt.call(this,Kt,1)},t.prototype.subscribe=function(t){this.exec=t},t.prototype.inform=function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.exec&&"function"==typeof this.exec&&this.exec.apply(null,e)},t.prototype.storeRef=function(t){window.__keetGlobalComponentRef__=window.__keetGlobalComponentRef__||[],~window.__keetGlobalComponentRef__.map(function(t){return t.identifier}).indexOf(t)?it(!1,"The component name: "+t+" already exist in the global pool."):window.__keetGlobalComponentRef__=window.__keetGlobalComponentRef__.concat({identifier:t,component:this})},at(t,null,[{key:"indentity",get:function(){return Y()}}]),t}(),t.html=nt,t.CreateModel=re,t}({});
//# sourceMappingURL=keet-min.js.map